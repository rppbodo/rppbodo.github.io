<!doctype html>
<html><head>
<meta charset="utf-8">
<title>Music Similarity Models</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="./css/d3js.css">
<link rel="stylesheet" type="text/css" href="./css/music-similarity-models.css">
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"> </script>
<script>
var comparator = function(index) {
	return function(a, b) {
		var valA = getCellValue(a, index);
		var valB = getCellValue(b, index);
		return $.isNumeric(valA) && $.isNumeric(valB) ? valA - valB : valA.toString().localeCompare(valB);
	}
};

var getCellValue = function(row, index) {
	return $(row).children("td").eq(index).text();
};

var onLoad = function() {
	$(".nav-link").click(function() {
		$(".nav-link").removeClass("active");
		$(this).addClass("active");
		var index = $(this).parents().eq(0).index();
		if (index == 0) {
			$("#chart-container").show();
			$("#table-container").hide();
		} else if (index == 1) {
			$("#chart-container").hide();
			$("#table-container").show();
		}
	});
	
	$.getJSON("./json/music-similarity-models.json", function(data) {
		$.each(data.models, function(key, val) {
			var html = "<tr>";
			html += "<td>" + val.extractor + "</td>";
			html += "<td>" + val.aggregator + "</td>";
			html += "<td>" + val.distance + "</td>";
			html += "</tr>"
			$("#table-container table tbody").append(html);
		});
	});
	
	$("th").each(function() {
		$(this).append("<div class=\"arrows\"></div>");
	});
	
	$("th").click(function() {
		var table = $(this).parents("table").eq(0);
		var rows = table.find("tr:gt(0)").toArray().sort(comparator($(this).index()));
		this.asc = !this.asc;
		$("th").children(".arrows").removeClass("th_sort_desc");
		$("th").children(".arrows").removeClass("th_sort_asc");
		if (!this.asc) {
			rows = rows.reverse();
			$(this).children(".arrows").addClass("th_sort_asc");
		} else {
			$(this).children(".arrows").addClass("th_sort_desc");
		}
		for (var i = 0; i < rows.length; i++) {
			table.append(rows[i]);
		}
	});
};
</script>
</head><body onLoad="onLoad();">
<ul class="nav nav-tabs">
<li class="nav-item"><a class="nav-link active" href="#">Chart</a></li>
<li class="nav-item"><a class="nav-link" href="#">Table</a></li>
</ul>
<div id="chart-container"></div>
<div id="table-container">
	<table class="table table-hover">
		<thead>
			<tr><th>extractor</th><th>aggregator</th><th>distance</th></tr>
		</thead>
		<tbody>
		</tbody>
	</table>
</div>
<script type="module">

import define from "./js/music-similarity-models.js";
import {Runtime, Library, Inspector} from "./d3js.js";

const runtime = new Runtime();
const main = runtime.module(define, Inspector.into(document.getElementById("chart-container")));

</script>
</body></html>
